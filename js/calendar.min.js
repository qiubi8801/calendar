function Calendar(t,i){this.wrap=t,this.days=[],this.rows=5,this.lan=i||"en",this.year=0,this.month=0,this.tempWidth=$(".day_list",this.wrap).width(),this.duration=300}Calendar.prototype={init:function(){var t=new Date;this.year=t.getFullYear(),this.month=t.getMonth(),this.update()},bindEvent:function(){var t=this,i=$(".day_list",t.wrap);$(".btn_prev",t.wrap).on("click",function(){t.goPrev()}),$(".btn_next",t.wrap).on("click",function(){t.goNext()}),t._swipe(i[0],function(){t.goNext()},function(){t.goPrev()})},goPrev:function(){var t=this;$('<ul class="prev_month"></ul>').prependTo(".day_list_inner",t.wrap),$(".day_list_inner",this.wrap).css({width:2*this.tempWidth,left:-this.tempWidth}),$(".day_list_inner ul",this.wrap).css({width:this.tempWidth}),0==this.month?(this.render(this.year-1,11,$(".prev_month",this.wrap)),$(".day_list_inner",this.wrap).animate({left:0},t.duration,function(){$(".cur_month",t.wrap).remove(),$(".day_list_inner",t.wrap).css("left",0),$(".prev_month",t.wrap).attr("class","cur_month")}),this.year=this.year-1,this.month=11):(this.render(this.year,this.month-1,$(".prev_month",this.wrap)),$(".day_list_inner",this.wrap).animate({left:0},t.duration,function(){$(".cur_month",t.wrap).remove(),$(".day_list_inner",t.wrap).css("left",0),$(".prev_month",t.wrap).attr("class","cur_month")}),this.month=this.month-1)},goNext:function(){var t=this;$('<ul class="next_month"></ul>').appendTo(".day_list_inner",t.wrap),$(".day_list_inner",this.wrap).css({width:2*this.tempWidth}),$(".day_list_inner ul",this.wrap).css({width:this.tempWidth}),11==this.month?(this.render(this.year+1,0,$(".next_month",this.wrap)),$(".day_list_inner",this.wrap).animate({left:-this.tempWidth},t.duration,function(){$(".cur_month",t.wrap).remove(),$(".day_list_inner",t.wrap).css("left",0),$(".next_month",t.wrap).attr("class","cur_month")}),this.year=this.year+1,this.month=0):(this.render(this.year,this.month+1,$(".next_month",this.wrap)),$(".day_list_inner",this.wrap).animate({left:-this.tempWidth},t.duration,function(){$(".cur_month",t.wrap).remove(),$(".day_list_inner",t.wrap).css("left",0),$(".next_month",t.wrap).attr("class","cur_month")}),this.month=this.month+1)},update:function(){this.render(this.year,this.month,$(".cur_month",this.wrap)),this.bindEvent()},render:function(t,i,n){var e=this,s=[];if($(".curMonth",e.wrap).html(t+"年"+(i+1)+"月"),"zh"==this.lan){var a=["日","一","二","三","四","五","六"];tempWeekHd=[];for(var r=0;r<a.length;r++)tempWeekHd.push("<li>"+a[r]+"</li>");e.wrap.find(".week_hd ul").html(tempWeekHd.join(""))}this.rows=Math.ceil((this._getDays(t,i)+this._getFirstDay(t,i))/7);for(var r=0;r<e.rows;r++){s.push("<li>");for(var h=0;h<7;h++){var o=7*r+h,p=o-e._getFirstDay(t,i)+1;p<=0?s.push('<div class="day_item"><span></span></div>'):p>e._getDays(t,i)?s.push('<div class="day_item"><span></span></div>'):s.push('<div class="day_item"><span>'+p+"</span></div>")}s.push("</li>")}n.html(s.join("")),$(".day_list",e.wrap).css({height:$(".day_list li",this.wrap).height()*this.rows})},_getFirstDay:function(t,i){var n=new Date(t,i,1).getDay();return n},_getDays:function(t,i){var n=[31,28+this._is_leap(t),31,30,31,31,30,31,30,31,30,31];return n[i]},_is_leap:function(t){return t%100==0?res=t%400==0?1:0:res=t%4==0?1:0},_swipe:function(t,i,n){var e,s,a;t.addEventListener("touchstart",function(t){var i=t.touches[0];s=i.clientX,a=i.clientY,e=!1},!1),t.addEventListener("touchmove",function(t){e=!0},!1),t.addEventListener("touchend",function(t){if(e){var r=t.changedTouches[0],h=r.clientX,o=r.clientY,p=s-h;distanceY=a-o,isSwipe=!1,Math.abs(p)>=Math.abs(distanceY)&&(p>20?(t.preventDefault(),i()):p<-20&&(t.preventDefault(),n()),p&&t.preventDefault(),isSwipe=!0)}},!1)}};